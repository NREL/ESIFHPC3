# FIO
[FIO Github](https://github.com/axboe/fio) commit 8410657 must be used to generate offered results.

## License
GPL-2

## Example Build
    module load gcc/8.4.0
    ./configure --prefix=/scratch/cchang/fio --cc=gcc --extra-cflags="-march=skylake"
    make; make install

## Test Configurations
File system targets are the Home file system, Projects file system, and Scratch file system as described in the RFP.
Node targets are Standard, Accelerated, and Large Data.

Tests cover the following space outside of the FIO defaults.

The following are controlled in the individual .fio job files.
1. unbuffered or buffered, via the `direct=` option
2. sequential or random, via the `rw=` option
3. read, write, or a mixture, also the the `rw=` option

The next set are controlled at the command line.

4. blocksize in `{4k, 64k, 1m}`
5. job size in `{1m, 64m, 1g}`
6. number of jobs in `{1, 1/2 * cores/node, cores/node - 1}`

As noted in the [online documentation](https://fio.readthedocs.io/en/latest/fio_doc.html#running-fio), `gettimeofday` calls may create core contention irrelevant to the actual I/O system performance. For this reason, we lock these calls to core 0 and limit runs to (N-1) cores, where each node has N cores.

## How to Run
An example Slurm bash script is provided.

## Allowed and Disallowed Optimizations
* The `rw`, `rwmixread`, `unit_base`, and `direct` settings may not be changed within the provided jobfiles.
* Other settings present may be changed except as noted below. Additional settings may be made. Any changes should be reported in the Text response.
* The requested job sizes and block sizes must be run and reported for the "as is" results. They may be changed for "optimized" results in the Spreadsheet Response.
* Unbuffered tests should use the `sync` ioengine. However, the ioengine setting for buffered tests may use any asynchronous option.
* For "as-is" results, files should not be striped, nor file access otherwise parallelized beyond what is intrinsic to the offering. In other words, these results should reflect simple system `read` or `write` calls (or asynchronous counterparts as appropriate) in production, with no user intervention to achieve performance. Optimized results may take full advantage of the offering's capabilities.

## Reporting Results
* __File Response__: All modified jobfiles, submission scripts, and output log files corresponding to the numbers reported in the Spreadsheet Response. The raw data files generated by FIO should not be returned. If code changes are made, either patch files should be provided in the File Response, or Issue numbers as described below.
* __Text Response__: High level summaries of any changes made to jobfiles, including the rationale for the changes. High level summary of any code changes or runtime optimizations (including striping, etc.) made to generate Optimized results. If code changes are made and an issue and pull request are created on the FIO Github, references should be provided here that would permit NREL to access this information on the FIO Github.
* __Spreadsheet Response__: See General Instructions. The file `parse.py` used to generate a CSV file from NREL reference data to import into the response Spreadsheet is provided for convenience. It may be modified by the Offeror to facilitate import of data.
